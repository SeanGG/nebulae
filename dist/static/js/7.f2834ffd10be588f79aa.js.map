{"version":3,"sources":["webpack:///./src/utils/appBridge.js","webpack:///./node_modules/_core-js@2.5.5@core-js/library/fn/json/stringify.js","webpack:///./node_modules/_babel-runtime@6.26.0@babel-runtime/core-js/json/stringify.js","webpack:///./src/page/appApi/appApi.vue?b246","webpack:///./src/page/appApi/appApi.vue","webpack:///./src/page/appApi/appApi.vue?b9ca","webpack:///./src/page/appApi/index.js","webpack:///src/page/appApi/appApi.vue","webpack:///./src/utils/platform.js"],"names":["appBridge","ready","fn","apiName","Object","_platform__WEBPACK_IMPORTED_MODULE_0__","result","window","webkit","messageHandlers","error","console","time","timer","setInterval","log","clearInterval","timer2","setTimeout","clearTimeout","hideLoading","_this","boot","showAppLocalProgress","showLoading","core","__webpack_require__","$JSON","JSON","stringify","module","exports","it","apply","arguments","default","__esModule","appApi_appApivue_type_script_lang_js","appApi_appApi","componentNormalizer","_vm","this","_h","$createElement","_c","_self","staticClass","_m","_v","_s","userAgent","_l","item","index","key","gridName","apiCell","apiIndex","attrs","data-key","on","click","testApi","name","desc","__webpack_exports__","testAgent","_utils_platform__WEBPACK_IMPORTED_MODULE_2__","dict","obj","postString","_ua","navigator","isApp","isWeixin","test"],"mappings":"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","file":"static/js/7.f2834ffd10be588f79aa.js","sourcesContent":["import {\n  isApp\n} from './platform'\n\n// location.search获取\nexport const appBridge = {\n  ready: (fn, apiName) => {\n    let isAppStatus = isApp()\n    if (isAppStatus) {\n    var result = window.webkit ? window.webkit.messageHandlers : ''\n    if (result) {\n      // fn && fn(result)\n      // if (fn) {\n      try {\n        fn(result)\n      } catch (error) {\n        console.error(`The native ${apiName} not exist !`)\n      }\n      // }\n    } else {\n      var time = 1\n      var timer = setInterval(function () {\n        console.log(time++)\n        result = window.webkit ? window.webkit.messageHandlers : ''\n        if (result) {\n          clearInterval(timer)\n          try {\n            fn(result)\n          } catch (error) {\n            console.error(`The native ${apiName} not exist !`)\n          }\n        }\n      }, 200)\n      const timer2 = setTimeout(function () {\n        clearInterval(timer)\n        clearTimeout(timer2)\n        console.error(`5sec later ! Timeout ! The native ${apiName} not exist !`)\n      }, 5000)\n    }\n    };\n  },\n  hideLoading: () => {\n    this.ready(function (boot) {\n      boot.showAppLocalProgress(false)\n    })\n  },\n  showLoading: () => {\n    this.ready(function (boot) {\n      boot.showAppLocalProgress(true)\n    })\n  }\n}\n","var core = require('../../modules/_core');\nvar $JSON = core.JSON || (core.JSON = { stringify: JSON.stringify });\nmodule.exports = function stringify(it) { // eslint-disable-line no-unused-vars\n  return $JSON.stringify.apply($JSON, arguments);\n};\n","module.exports = { \"default\": require(\"core-js/library/fn/json/stringify\"), __esModule: true };","import mod from \"-!../../../node_modules/_babel-loader@7.1.4@babel-loader/lib/index.js!../../../node_modules/_vue-loader@15.0.7@vue-loader/lib/index.js??vue-loader-options!./appApi.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/_babel-loader@7.1.4@babel-loader/lib/index.js!../../../node_modules/_vue-loader@15.0.7@vue-loader/lib/index.js??vue-loader-options!./appApi.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./appApi.vue?vue&type=template&id=48d53a79\"\nimport script from \"./appApi.vue?vue&type=script&lang=js\"\nexport * from \"./appApi.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.0.7@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"content\"},[_vm._m(0),_vm._v(\" \"),_c('main',[_c('section',{staticClass:\"alert\"},[_vm._v(\"当前环境：\\n      \"),_c('span',{staticClass:\"agent\"},[_vm._v(_vm._s(_vm.userAgent))])]),_vm._v(\" \"),_vm._l((_vm.apiList),function(item,index){return _c('section',{key:index},[_c('section',{staticClass:\"h2\"},[_vm._v(_vm._s(item.gridName))]),_vm._v(\" \"),_c('ul',{staticClass:\"api-list\"},_vm._l((item.gridList),function(apiCell,apiIndex){return _c('li',{key:apiIndex},[_c('section',{staticClass:\"api-cell\",attrs:{\"data-key\":apiCell.key},on:{\"click\":_vm.testApi}},[_c('section',{staticClass:\"api-btn\"},[_vm._v(_vm._s(apiCell.name))]),_vm._v(\" \"),_c('section',{staticClass:\"api-desc\"},[_vm._v(_vm._s(apiCell.desc))])])])}))])})],2)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('header',[_c('section',{staticClass:\"title\"},[_vm._v(\"appApi列表\")]),_vm._v(\" \"),_c('section',{staticClass:\"description\"},[_vm._v(\"app提供原生功能接口\")])])}]\nexport { render, staticRenderFns }","import './appApi.scss'\nimport AppApi from './appApi.vue'\n\nexport default AppApi\n","<template>\n  <div class=\"content\">\n    <header>\n      <section class=\"title\">appApi列表</section>\n      <section class=\"description\">app提供原生功能接口</section>\n    </header>\n    <main>\n      <section class=\"alert\">当前环境：\n        <span class=\"agent\">{{userAgent}}</span>\n      </section>\n      <!-- api分类1 -->\n      <section :key=\"index\" v-for=\"(item,index) in apiList\">\n        <section class=\"h2\">{{item.gridName}}</section>\n        <ul class=\"api-list\">\n          <li :key=\"apiIndex\" v-for=\"(apiCell, apiIndex) in item.gridList\">\n            <section class=\"api-cell\" @click=\"testApi\" :data-key=\"apiCell.key\">\n              <section class=\"api-btn\">{{apiCell.name}}</section>\n              <section class=\"api-desc\">{{apiCell.desc}}</section>\n            </section>\n          </li>\n        </ul>\n      </section>\n    </main>\n  </div>\n</template>\n\n<script>\nimport { appBridge } from '@/utils/appBridge'\nimport { isApp, isWeixin } from '@/utils/platform'\nexport default {\n  name: 'AppAPi',\n  data () {\n    return {\n      userAgent: '当前环境计算中...',\n      apiList: [\n        {\n          gridName: '基础功能api',\n          gridList: [\n            {\n              name: 'app是否已安装',\n              key: 'isAppCanOpen',\n              desc: 'app是否已安装'\n            },\n            {\n              name: '打开app',\n              key: 'openApp',\n              desc: '打开app'\n            },\n            {\n              name: '测试奖励弹框',\n              key: 'taskRewardAlert',\n              desc: '测试奖励弹框'\n            },\n            {\n              name: '隐藏导航栏',\n              key: 'hideNavigation',\n              desc: '隐藏导航栏'\n            },\n            {\n              name: '显示导航栏',\n              key: 'showNavigation',\n              desc: '显示导航栏'\n            }\n          ]\n        },\n        {\n          gridName: '支付api',\n          gridList: [\n            {\n              name: 'reqSession',\n              key: 'reqSession',\n              desc: 'reqSession'\n            },\n            {\n              name: 'reqPay',\n              key: 'reqPay',\n              desc: '支付'\n            },\n            {\n              name: 'reqClose',\n              key: 'reqClose',\n              desc: 'reqClose'\n            },\n            {\n              name: '音频播放',\n              key: 'reqAudioStart',\n              desc: '音频播放'\n            },\n            {\n              name: '音频暂停',\n              key: 'reqAudioPause',\n              desc: '音频暂停'\n            },\n            {\n              name: '音频停止',\n              key: 'reqAudioStop',\n              desc: '音频停止'\n            },\n          ]\n        }\n      ]\n    }\n  },\n  computed: {},\n  created () {\n    this.testAgent();\n  },\n  methods: {\n    testAgent () {\n      const isAppStatus = isApp(),\n        isWeixinStatus = isWeixin()\n\n      if (isAppStatus) {\n        this.userAgent = 'app'\n      } else if (isWeixinStatus) {\n        this.userAgent = 'weixin'\n      } else {\n        this.userAgent = 'h5'\n      }\n    },\n    testApi (e) {\n      if (this.userAgent && this.userAgent === \"h5\") {\n        alert('当前环境不在app内，无法调用app接口');\n        return;\n      }\n      const key = e.currentTarget.dataset.key;\n      // eval(`this.${key}(key)`)\n      try {\n        eval(`this.${key}(key)`)\n      } catch (error) {\n        console.error(`不存在 ${key} 方法 !请确认是否正确配置`)\n      }\n    },\n    // app方法\n    // 判断是否安装\n    isAppCanOpen (name) {\n      const key = name || 'unknowApi-isAppCanOpen'\n      // try {\n      //   webkit.messageHandlers.isAppCanOpen.postMessage({ url: \"wxc21a915b1ea48402://\" })\n      // } catch (error) {\n      //   console.error(`The native ${key} not exist !`)\n      // }\n      appBridge.ready(function (e) {\n        e.isAppCanOpen.postMessage({ url: \"wxc21a915b1ea48402://\" })\n      }, 'isAppCanOpen')\n    },\n    // 打开app\n    openApp (name) {\n      const key = name || 'unknowApi-openApp'\n      try {\n        webkit.messageHandlers.openApp.postMessage({ url: \"wxc21a915b1ea48402://\" })\n      } catch (error) {\n        console.error(`The native ${key} not exist !`)\n      }\n    },\n    // 测试奖励弹框\n    taskRewardAlert (name) {\n      const key = name || 'unknowApi-openApp'\n      // try {\n      //   webkit.messageHandlers.taskRewardAlert.postMessage({ title: \"任务奖励测试\", coin: 0.2, power: 0 })\n      // } catch (error) {\n      //   console.error(`The native ${key} not exist !`)\n      // }\n      appBridge.ready(function (e) {\n        e.taskRewardAlert.postMessage({ title: \"任务奖励测试\", coin: 0.2, power: 0 })\n      }, 'taskRewardAlert')\n    },\n    // 显示导航栏\n    showNavigation (name) {\n      const key = name || 'unknowApi-openApp'\n      try {\n        webkit.messageHandlers.showNavigation.postMessage({})\n      } catch (error) {\n        console.error(`The native ${key} not exist !`)\n      }\n    },\n    // 隐藏导航栏\n    hideNavigation (name) {\n      const key = name || 'unknowApi-openApp'\n      try {\n        webkit.messageHandlers.hideNavigation.postMessage({})\n      } catch (error) {\n        console.error(`The native ${key} not exist !`)\n      }\n    },\n    reqSession () {\n      this.callNative(\"reqSession\", {});\n    },\n    reqPay () {\n      /*\n      | 参数        | 类型           | 意义   |\n      | ------------- |:-------------:| -----:|\n      |  session | string | 是 | 用户session | - | xxxxxx |\n      |  subGameId | string | 是 | 分配给h5游戏的id | - | xxxxxx |\n      |  productId | string | 是 | 商品id | - | xxxxxx |\n      |  productName | string | 是 | 商品名称 | - | 购买道具A |\n      |  productPrice | Int | 是 | 商品价格 | - | 实际花费的星钻值 x 100000 |\n      |  count | Int | 是 | 购买数量 | - | 2 |\n      |  extra | string | 是 | 扩展信息 | - | 购买道具A x 2 |\n      |  zoneId | string | 是 | h5游戏的分区id | - | xxxxxx |\n       */\n      //注意是utf8格式\n      this.callNative(\"reqPay\", { \"session\": \"96e26647eacf25679effe4b080e928fe\", \"subGameId\": \"aaa\", \"productId\": \"a\", \"productName\": \"aa\", \"productPrice\": 10, \"count\": 2, \"extra\": \"购买aa x 2\", \"zoneId\": \"aa\" });\n    },\n\n    reqClose () {\n      callNative(\"reqClose\", {});\n    },\n\n    reqAudioStart () {\n      /*\n      | 参数        | 类型           | 意义   |\n      | ------------- |:-------------:| -----:|\n      |  url | string | 是 | 播放的音频url | - | xxxxxx |\n       */\n      //注意是utf8格式\n      this.callNative(\"reqAudioStart\", { \"url\": \"http://xxx\" });\n    },\n    reqAudioPause () {\n      this.callNative(\"reqAudioPause\", {});\n    },\n    reqAudioClose () {\n      this.callNative(\"reqAudioClose\", {});\n    },\n    callNative (commandName, dict) {\n      var obj;\n      var params;\n      if (dict == null) {\n        params = {};\n      } else {\n        params = dict;\n      }\n      var obj = { \"command\": commandName, \"data\": params };\n      var postString = JSON.stringify(obj);\n      console.log(\"callNative postString:\", postString);\n      if (/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)) {\n        appBridge.ready(function (e) {\n          e.NativeBridge.postMessage(obj);\n        })\n      } else {\n        appBridge.ready(function () {\n          NativeBridge.postMessage(postString);\n        })\n      }\n      //console.log(\"callNative commandName:\", commandName, \" dict:\",dict);\n      // setTimeout(function () {\n      //   if (/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)) {\n      //     // ios\n      //     var obj;\n      //     var params;\n      //     if (dict == null) {\n      //       params = {};\n      //     } else {\n      //       params = dict;\n      //     }\n      //     var obj = { \"command\": commandName, \"data\": params };\n      //     var postString = JSON.stringify(obj);\n\n      //     console.log(\"callNative postString:\", postString);\n      //     window.webkit.messageHandlers.NativeBridge.postMessage(obj);\n      //   } else if (/(Android)/i.test(navigator.userAgent)) {\n      //     // android\n      //     var obj;\n      //     var params;\n      //     if (dict == null) {\n      //       params = {};\n      //     } else {\n      //       params = dict;\n      //     }\n      //     var obj = { \"command\": commandName, \"data\": params };\n      //     var postString = JSON.stringify(obj);\n      //     console.log(\"callNative postString:\", postString);\n      //     NativeBridge.postMessage(postString);\n      //   } else {\n      //   };\n      // }, 0);\n    }\n  }\n}\n</script>\n","let _ua = window.navigator.userAgent\n\nexport const isApp = () => {\n  // return /zhonganwebview/i.test(_ua)\n  return true\n}\n\nexport const isWeixin = () => {\n  return /micromessenger/i.test(_ua)\n}\n\n// 手机类型判定\nexport const typePhone = () => {\n  // const u = navigator.userAgent,\n    // device = ''\n  if (_ua.indexOf('Android') > -1 || _ua.indexOf('Linux') > -1) {\n    return 'android'\n  } else if (_ua.indexOf('iPhone') > -1) {\n    return 'ios'\n  }\n}\n"],"sourceRoot":""}